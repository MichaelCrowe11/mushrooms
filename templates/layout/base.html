<!DOCTYPE html>
<html class="no-js" lang="{{ locale_name }}">
<head>
    <!-- =============================================================
         Southwest Mushrooms ¬∑ BigCommerce Stencil Theme
         -------------------------------------------------------------
         ‚Ä¢ Clean, minimal head section
         ‚Ä¢ Optimized asset loading
         ‚Ä¢ Glass morphism design system
    ============================================================= -->
    <title>{{ head.title }}</title>
    {{{ head.meta_tags }}}
    {{{ head.config }}}
    
    <!-- Critical CSS for above-the-fold content -->
    <style>
        /* Critical CSS for immediate rendering */
        body{margin:0;font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f5f5f5}
        .glass-sidebar{position:fixed;top:0;left:0;width:320px;height:100vh;background:rgba(255,255,255,0.85);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:1000}
        .main-content{margin-left:320px;min-height:100vh;transition:margin-left 0.3s ease}
        .sidebar-logo{display:block;width:120px;height:auto}
        .mobile-toggle{display:none;position:fixed;top:20px;left:20px;z-index:1001;background:rgba(255,255,255,0.9);backdrop-filter:blur(10px);border:none;padding:10px;border-radius:12px}
        @media(max-width:991px){
            .glass-sidebar{transform:translateX(-100%);transition:transform 0.3s ease}
            .glass-sidebar.active{transform:translateX(0)}
            .main-content{margin-left:0}
            .mobile-toggle{display:flex;align-items:center;gap:10px}
        }
        /* Prevent layout shift for images */
        img{max-width:100%;height:auto}
        .sidebar-logo,.mobile-logo{width:120px;height:40px;object-fit:contain}
    </style>
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="{{ head.cdn_url }}" crossorigin>
    <link rel="preconnect" href="https://cdn11.bigcommerce.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn11.bigcommerce.com/s-qe8ntvzzrw/images/stencil/original/image-manager/southwest-mushrooms-logo-design.png" as="image" fetchpriority="high">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style">
    <link rel="preload" href="{{ cdn 'assets/css/theme.css' }}" as="style">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Core Styles -->
    <link href="{{ head.favicon }}" rel="shortcut icon">
    {{{ stylesheet '/assets/css/theme.css' }}}

    <!-- Async Scripts -->
    {{{ head.scripts }}}

    {{!-- Google Analytics --}}
    {{#if google_analytics_id}}
        <script async src="https://www.googletagmanager.com/gtag/js?id={{google_analytics_id}}"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', '{{google_analytics_id}}');
        </script>
    {{/if}}

    {{{ snippets }}}
</head>
<body data-theme="light">
    <!-- Skip to main content link for accessibility -->
    <a class="skip-link" href="#main-content">Skip to main content</a>

    <!-- =============================================================
         Glass Morphism Sidebar
    ============================================================= -->
    <aside class="glass-sidebar openai-sidebar" data-state="expanded">
        <!-- Brand -->
        <header class="glass-sidebar__header">
            <a href="{{ urls.home }}" class="sidebar-brand">
                <img src="https://cdn11.bigcommerce.com/s-qe8ntvzzrw/images/stencil/original/image-manager/southwest-mushrooms-logo-design.png"
                     alt="Southwest Mushrooms"
                     class="sidebar-logo"
                     width="120"
                     height="40"
                     fetchpriority="high"
                     decoding="async">
            </a>
            <button class="sidebar-toggle" aria-label="Toggle sidebar">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </header>

        <!-- Navigation -->
        <nav class="glass-sidebar__nav" aria-label="Primary navigation">
            {{> components/common/sidebar-navigation}}
            
            <!-- Circular Widgets -->
            {{> components/common/circular-widgets}}
        </nav>

        <!-- Footer -->
        <footer class="glass-sidebar__footer">
            <div class="social-links">
                {{#if social_media}}
                    {{#each social_media}}
                        <a href="{{ url }}" aria-label="{{ name }}" target="_blank" rel="noopener noreferrer">
                            {{> components/common/icon name=icon}}
                        </a>
                    {{/each}}
                {{/if}}
            </div>
            
            <button class="theme-toggle-widget" data-widget-action="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon-light">‚òÄÔ∏è</span>
                <span class="theme-icon-dark" style="display: none;">üåô</span>
                <span class="theme-text">Theme</span>
            </button>
            
            <p class="sidebar-footer-text">¬© <span data-year></span> {{ settings.store_name }}</p>
        </footer>
    </aside>

    <!-- Mobile Toggle (fixed position) -->
    <button class="mobile-toggle" aria-label="Open menu">
        <img src="https://cdn11.bigcommerce.com/s-qe8ntvzzrw/images/stencil/original/image-manager/southwest-mushrooms-logo-design.png"
             alt="Southwest Mushrooms"
             class="mobile-logo"
             width="120"
             height="40"
             loading="eager"
             decoding="async">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- =============================================================
         Main Content Area
    ============================================================= -->
    <main id="main-content" class="main-content" role="main">
        {{!-- Header with logo (from surgical fix) --}}
        {{> components/common/header}}
        
        {{!-- Dynamic page content --}}
        <div class="page-content">
            {{{ body }}}
        </div>
        
        {{!-- Footer --}}
        {{> components/common/footer}}
    </main>

    <!-- =============================================================
         Product Card Template (for dynamic rendering)
    ============================================================= -->
    <template id="tpl-product-card">
        <article class="product-card glass-card">
            <figure class="product-media">
                <img loading="lazy" alt="">
            </figure>
            <div class="product-info">
                <h3 class="product-title"></h3>
                <p class="product-price"></p>
                <button class="btn btn-primary add-to-cart" data-product-id="">
                    Add to Cart
                </button>
            </div>
        </article>
    </template>

    <!-- =============================================================
         Scripts
    ============================================================= -->
    <script>window.__webpack_public_path__ = "{{ cdn 'assets/dist/' }}";</script>
    <script src="{{cdn 'assets/dist/theme-bundle.main.js' }}" defer></script>
    
    {{!-- BigCommerce remote scripts --}}
    {{{ footer.scripts }}}
    
    {{!-- AI Chat Interface --}}
    {{> components/common/ai-chat}}
    
    {{!-- Initialize year dynamically --}}
    <script>
        document.querySelector('[data-year]').textContent = new Date().getFullYear();
    </script>
</body>
</html>
